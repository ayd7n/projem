# Stok Hareketleri Analiz Raporu

## Proje: Parfüm ERP Sistemi

### 1. Genel Yapı

Sistemde üç ana stok türü bulunmaktadır:
- **Malzeme** (malzemeler tablosu)
- **Esans** (esanslar tablosu) 
- **Ürün** (urunler tablosu)

Stok hareketleri merkezi olarak **stok_hareket_kayitlari** tablosunda takip edilmektedir.

### 2. Stok Artışı Nedenleri

#### 2.1 Manuel Girişler
- **Sayım Fazlası**: Stok sayımı sırasında fazla malzeme tespiti durumunda
- **Stok Düzeltme (Artış)**: Manuel olarak stok miktarı düzeltme
- **Fire/Çıkış Geri Alımı**: Yanlışlıkla kaydedilen fire hareketinin düzeltme kaydı

#### 2.2 Tedarik ve Alım Hareketleri
- **Mal Kabul**: Tedarikçiden gelen malzemenin kabulü
- **Satın Alma**: Dışarıdan alınan ürünlerin stoka eklenmesi

#### 2.3 Üretim Hareketleri
- **Üretim Girişi**: Montaj/üretim sonucu üretilen ürünlerin stoğa girişi
- **Esans Üretim Girişi**: Esans üretim sonucu stoğa giren ürünler
- **İade Girişi**: Müşteriden gelen ürünlerin stoğa iadesi

#### 2.4 Diğer Girişler
- **Numune Girişi**: Numune olarak gelen ürünlerin stoğa alınması
- **Transfer Girişi**: Başka bir konumdan transfer edilen ürünler

### 3. Stok Azalış Nedenleri

#### 3.1 Satış ve Sipariş Hareketleri
- **Müşteri Siparişleri**: Sipariş "Tamamlandı" durumuna getirildiğinde ürünler stoktan düşülür
- **İade Çıkışı**: Müşteriye teslim edilen ürünün iadesi (stoktan düşer)

#### 3.2 Üretim Hareketleri
- **Montaj/Üretim Girişi için Malzeme Çıkışı**: Ürün üretimi sırasında kullanılan malzemeler stoktan düşülür
- **Esans Üretimi için Bileşen Çıkışı**: Parfüm üretimi sırasında kullanılan essans'ler stoktan düşülür

#### 3.3 Manuel Çıkışlar
- **Fire/Çıkış**: Gerçekleşen fire kayıtları
- **Sayım Eksigi**: Stok sayımında eksik çıkan malzeme kayıtları
- **Stok Düzeltme (Azalış)**: Manuel olarak stok miktarı düzeltme
- **Numune Çıkışı**: Numune olarak verilen ürünler

#### 3.4 Diğer Çıkışlar
- **Transfer Çıkışı**: Başka bir konuma transfer edilen ürünler
- **İade Çıkışı**: Müşteriye iade edilen ürünlerin stoğa girişi durumunun iptali

### 4. Stok Hareketleri Detayları

#### 4.1 Sipariş ile Stok Azalımı (musteri_siparisleri.php)
- Sipariş durumu "Tamamlandı" olarak değiştirildiğinde:
  - Ürünlerin stok miktarları sipariş edilen miktarda azaltılır
  - Stok hareket kaydı oluşturulur (yon: çıkış, hareket_turu: çıkış)
  - Stok hareketine müşteri bilgileri ve ilgili belge no eklenir

#### 4.2 Montaj İş Emri ile Stok Hareketleri (montaj_is_emirleri_islemler.php)
- İş emri başlatıldığında:
  - Kullanılacak bileşenler stoktan düşülür (yon: çıkış)
  - "Üretime Çıkış" hareketi kaydedilir
- İş emri tamamlandığında:
  - Üretilen ürün stoka eklenir (yon: giriş)
  - "Üretimden Giriş" hareketi kaydedilir

#### 4.3 Esans İş Emri ile Stok Hareketleri (esans_is_emirleri_islemler.php)
- Esans üretimi sırasında:
  - Kullanılan malzeme bileşenleri stoktan düşülür (yon: çıkış)
  - Üretilen essans stoğa eklenir (yon: giriş)
  - Her iki işlem için de stok hareket kayıtları oluşturulur

### 5. Stok Yönleri ve Hareket Türleri

#### 5.1 Yönler
- **Giriş** (giris): Stok miktarını artırır
- **Çıkış** (cikis): Stok miktarını azaltır

#### 5.2 Hareket Türleri
- **Giriş Türleri**:
  - stok_giris
  - uretim_giris
  - iade_girisi
  - stok_duzeltme (artış)
  - transfer (giriş)
  - sayim_fazlasi
  - numune_girisi
  - mal_kabul

- **Çıkış Türleri**:
  - stok_cikis
  - fire_cikisi
  - stok_duzeltme (azalış)
  - transfer (çıkış)
  - numune_cikisi
  - iptal_cikis
  - uretime_cikis
  - uretimden_iade

### 6. Stok Takibi

Her ürün türü için stok miktarı ayrı tablolarda takip edilmektedir:
- **malzemeler** tablosu: malzeme_kodu, stok_miktari
- **esanslar** tablosu: esans_kodu, stok_miktari
- **urunler** tablosu: urun_kodu, stok_miktari

Tüm hareketler **stok_hareket_kayitlari** tablosunda detaylı şekilde kayıtlı:
- hareket_id
- stok_turu (malzeme, esans, urun)
- kod (ürün kodu)
- isim (ürün adı)
- miktar
- yon (giris/cikis)
- hareket_turu
- depo/raf veya tank_kodu
- ilgili_belge_no
- is_emri_numarasi
- aciklama
- kaydeden_personel_id
- kaydeden_personel_adi
- tarih
- muster_id, musteri_adi (siparişlerde)

### 7. Özet

Sistemde stok hareketleri merkezi olarak yönetilmekte ve tüm işlemler detaylı şekilde kayıt altına alınmaktadır. Stoklar müşteri siparişleri, üretim süreçleri ve manuel giriş/çıkışlar neticesinde hem artmakta hem de azalmaktadır. Stok hareketleri sayesinde stok seviyesinin gerçek zamanlı takibi ve denetimi yapılabilmektedir.